# ============================================================================
# Short Squeeze Monitor - 环境变量配置模板
# ============================================================================
# 使用方法:
#   1. 复制此文件: cp env.example .env
#   2. 根据需要修改配置值
#   3. 程序启动时自动加载
# ============================================================================


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                           🌐 网络配置                                     ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# 代理 URL (可选)
# - 本地运行需要代理时填写，例如: http://127.0.0.1:7890
# - AWS 部署时留空即可直连
PROXY_URL=

# HTTP 请求超时 (秒)
HTTP_TIMEOUT=15

# 最大并发请求数 (避免触发 Binance 429 错误)
CONCURRENCY_LIMIT=5

# 遇到速率限制时的等待时间 (秒)
RATE_LIMIT_WAIT=5

# 最大重试次数
MAX_RETRIES=3


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                        🔑 Binance API (可选)                              ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# Binance API 密钥 (可选 - 配置后可获得更高速率限制)
# 获取地址: https://www.binance.com/zh-CN/my/settings/api-management
BINANCE_API_KEY=
BINANCE_API_SECRET=


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                         📱 Telegram 通知                                  ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# Telegram Bot Token (从 @BotFather 获取)
# 创建步骤:
#   1. 在 Telegram 搜索 @BotFather
#   2. 发送 /newbot 创建机器人
#   3. 复制 Bot Token 填入下方
TELEGRAM_BOT_TOKEN=

# Telegram Chat ID (你的用户ID 或 群组ID)
# 获取方法:
#   1. 向你的 Bot 发送一条消息
#   2. 访问 https://api.telegram.org/bot<YOUR_TOKEN>/getUpdates
#   3. 从返回的 JSON 中找到 chat.id
TELEGRAM_CHAT_ID=

# 每轮最大告警数量 (避免刷屏)
TELEGRAM_MAX_ALERTS=5

# 是否只发送强信号 (true/false)
# 设为 true 时只发送 STRONG 级别的信号
TELEGRAM_STRONG_ONLY=false

# 告警冷却时间 (分钟)
# - 同一信号在此时间内不重复发送，避免刷屏
# - 信号从 NORMAL 升级到 STRONG 时会突破冷却
ALERT_COOLDOWN_MINUTES=60


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                         📊 基础过滤参数                                    ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# 24小时最小交易量 (USDT)
# - 过滤掉流动性太差的土狗币，防止滑点过大
# - 建议值: 10000000 ~ 50000000
MIN_VOLUME_USDT=15000000

# 监控轮询间隔 (秒)
# - 每隔多少秒检查一次市场
# - 建议值: 300 (5分钟，配合 K 线的 15m/1h 节奏)
CHECK_INTERVAL_SECONDS=300


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                    🟠 普通信号阈值 (Normal Signal)                        ║
# ╚══════════════════════════════════════════════════════════════════════════╝
# 满足这个条件就发送通知，让你开始关注

# 资金费率阈值
# - 负费率表示市场看空情绪
# - -0.0005 = -0.05% (开始出现看空情绪)
NORMAL_FUNDING_RATE=-0.0005

# OI (持仓量) 增长比率
# - 表示短期 OI 与长期 OI 的比值
# - 1.2 = 1.2倍 (20% 增幅，有资金流入)
NORMAL_OI_RATIO=1.2


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                    🔴 强烈信号阈值 (STRONG Signal)                        ║
# ╚══════════════════════════════════════════════════════════════════════════╝
# 满足这个条件必须置顶！这是典型的轧空前兆

# 资金费率阈值
# - 极端负费率，说明空头极其拥挤
# - -0.0010 = -0.10%
STRONG_FUNDING_RATE=-0.0010

# OI 增长比率
# - 持仓翻倍，说明庄家大举进场
# - 2.0 = 2.0倍
STRONG_OI_RATIO=2.0


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                         📈 OI 分析参数                                     ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# 短期 OI 窗口 (用于计算短期移动平均)
# - 最近 N 个数据点的平均值
OI_SHORT_WINDOW=3

# 长期 OI 窗口 (用于计算长期移动平均)
# - 13 个周期 = 1 小时 (每 5 分钟 1 个周期)
OI_LONG_WINDOW=13


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                   ⏱️ OI 双窗口阈值 (15分钟 + 1小时)                       ║
# ╚══════════════════════════════════════════════════════════════════════════╝
# 双触发系统: 同时监控 15 分钟快速增长 和 1 小时持续趋势

# --- 15 分钟快速增长检测 ---
# STRONG: OI 15分钟内增长超过 12%
OI_15M_STRONG=0.12

# NORMAL: OI 15分钟内增长超过 5%
OI_15M_NORMAL=0.05

# --- 1 小时持续趋势检测 ---
# STRONG: OI 1小时内累计增长超过 30%
OI_1H_STRONG=0.30

# NORMAL: OI 1小时内累计增长超过 15%
OI_1H_NORMAL=0.15


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                      🛡️ BTC Veto (安全检查)                               ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# BTC Veto 触发阈值
# - 当 BTC 跌幅超过此阈值时，抑制 NORMAL 信号，警告 STRONG 信号
# - -0.01 = -1% (BTC 下跌超过 1% 触发)
BTC_VETO_THRESHOLD=-0.01

# 是否启用 BTC Veto
BTC_VETO_ENABLED=true


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                         📁 数据存储                                        ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# 历史数据存储目录
DATA_DIR=data


# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                         📝 日志配置                                        ║
# ╚══════════════════════════════════════════════════════════════════════════╝

# 日志级别: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO


# ============================================================================
# 配置说明
# ============================================================================
#
# 信号触发逻辑:
# ─────────────
#   🟠 NORMAL 信号:
#      - 资金费率 <= NORMAL_FUNDING_RATE (-0.05%)
#      - 或 OI 比率 >= NORMAL_OI_RATIO (1.2x)
#
#   🔴 STRONG 信号:
#      - 资金费率 <= STRONG_FUNDING_RATE (-0.10%)
#      - 或 OI 比率 >= STRONG_OI_RATIO (2.0x)
#
# 部署模式:
# ─────────
#   本地开发: 填写 PROXY_URL
#   AWS 部署: PROXY_URL 留空
#
# ============================================================================

